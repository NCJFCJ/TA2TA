(()=>{"use strict";const a=window.lodash;jQuery((function(t){function e(a,t=null){const e=a.find(".dlp-grid-documents");let i=a.find("footer .dlp-grid-pagination"),r=a.find("header .dlp-grid-pagination");const n=a.find("footer .dlp-grid-totals"),d=a.find("header .dlp-grid-totals");t&&t.grid&&e.replaceWith(t.grid),i.length>0&&t&&t.pagination&&i.replaceWith(t.pagination.footer),i=a.find("footer .dlp-grid-pagination"),i.children().length>0?i.show():i.hide(),r.length>0&&t&&t.pagination&&r.replaceWith(t.pagination.header).show(),r=a.find("header .dlp-grid-pagination"),r.children().length>0?r.show():r.hide(),n.length>0&&t&&t.totals&&n.replaceWith(t.totals.footer),d.length>0&&t&&t.totals&&d.replaceWith(t.totals.header)}new class{constructor(){t(document).on("click",".dlp-grid-paginate-button",this.handleFetchGrid),t(document).on("click",".dlp-grid-card-featured-img",this.openPhotoswipe),t(document).on("input",'.dlp-grid-search input[type="search"]',(0,a.debounce)(this.handleGridSearch,300)),t(document).on("click",".dlp-grid-reset",this.handleGridReset),t(".dlp-grid-container").each((function(a){e(t(this))}))}handleFetchGrid(a){const i=t(this);if(i.hasClass("disabled")||i.hasClass("current"))return;const r=i.parents(".dlp-grid-container").first(),n=r.attr("id"),d=t(this).data("page-number");let l="";l=i.parents(".dlp-folders-search-results").first()?.length?i.parents(".dlp-folders-container").first().find('.dlp-folders-search input[type="search"]').val():r.find('.dlp-grid-search input[type="search"]').val(),l&&l.length<dlp_grid_params.ajax_min_search_term_len&&(l=""),r.block({message:null,overlayCSS:{background:"#fff",opacity:.7}}),t.ajax({url:dlp_grid_params.ajax_url,type:"POST",data:{grid_id:n,page_number:d,search_query:l,action:dlp_grid_params.ajax_action,_ajax_nonce:dlp_grid_params.ajax_nonce},xhrFields:{withCredentials:!0}}).done((function(a){t("html, body").animate({scrollTop:r.offset().top-50},300),e(r,a),r.unblock()})),r.addClass("grid-loaded")}handleGridSearch(a){const i=t(this),r=i.parents(".dlp-grid-container").first(),n=r.find(".dlp-grid-reset"),d=r.attr("id");let l=r.find('.dlp-grid-search input[type="search"]').val();if(r.find('.dlp-grid-search input[type="search"]').not(this).each((function(a){t(this).val(i.val())})),l.length<dlp_grid_params.ajax_min_search_term_len){if(n.is(":hidden"))return;l="",n.hide()}else n.show();r.block({message:null,overlayCSS:{background:"#fff",opacity:.7}}),t.ajax({url:dlp_grid_params.ajax_url,type:"POST",data:{grid_id:d,search_query:l,page_number:1,action:dlp_grid_params.ajax_action,_ajax_nonce:dlp_grid_params.ajax_nonce},xhrFields:{withCredentials:!0}}).done((function(a){e(r,a),r.unblock()})),r.addClass("grid-loaded")}handleGridReset(a){a.preventDefault();const i=t(this).parents(".dlp-grid-container").first(),r=i.find(".dlp-grid-reset"),n=i.attr("id");i.find('.dlp-grid-search input[type="search"]').each((function(a){t(this).val("")})),r.hide(),i.block({message:null,overlayCSS:{background:"#fff",opacity:.7}}),t.ajax({url:dlp_grid_params.ajax_url,type:"POST",data:{grid_id:n,search_query:"",page_number:1,action:dlp_grid_params.ajax_action,_ajax_nonce:dlp_grid_params.ajax_nonce},xhrFields:{withCredentials:!0}}).done((function(a){e(i,a),i.unblock()}))}openPhotoswipe(a){a.stopPropagation();const e=t(".pswp")[0],i=t(this).find("img");if(i.length<1)return;const r=[{src:i.attr("data-large_image"),w:i.attr("data-large_image_width"),h:i.attr("data-large_image_height"),title:i.attr("data-caption")&&i.attr("data-caption").length?i.attr("data-caption"):i.attr("title")}];return new PhotoSwipe(e,PhotoSwipeUI_Default,r,{index:0,shareEl:!1,closeOnScroll:!1,history:!1,hideAnimationDuration:0,showAnimationDuration:0}).init(),!1}}}))})();